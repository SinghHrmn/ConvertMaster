{% extends 'base.html' %}

{% block content %}
<h1>json-csv</h1>
<form action="" method="post">
        {% csrf_token %}
        <label for="">JSON</label><br>
        <textarea name="json" id="input" cols="30" rows="10"></textarea>
    
        
        <label for="">CSV</label>
        <textarea name="json" id="output" cols="30" rows="10"></textarea>
        
            
        <input type="button" onclick="jsontocsv()" value="convert">
    </form>
    <script>
        function jsontocsv(){
            var data = new FormData();
            var json = document.getElementById('input').value;
            var token = '{{ csrf_token }}'
            data.append('json', json);
            data.append('csrfmiddlewaretoken', token);
            var request = new XMLHttpRequest();
            request.onreadystatechange = function (){
                if(this.readyState == 4 && this.status == 200){
                    var out = JSON.parse(this.response);
                    
                    document.getElementById('output').innerHTML = out['ans'];
                    
                }
            };
            request.open('POST', "{% url 'json-csv' %}", true);
            request.send(data);
        }
    </script>
    
{% endblock content %}